#include <dt-bindings/zmk/matrix_transform.h>
#include <physical_layouts.dtsi>

/ {

    iso122_ph_layout: iso122_ph_layout {
        compatible = "zmk,physical-layout";
        display-name = "ISO 122";
        transform = <&iso122_matrix_transform>;
        kscan = <&unified_kscan>;
        
        
        keys  //                     w   h    x    y     rot    rx    ry
            = <&key_physical_attrs 100 100  400    0       0     0     0>
            , <&key_physical_attrs 100 100  500    0       0     0     0>
            , <&key_physical_attrs 100 100  600    0       0     0     0>
            , <&key_physical_attrs 100 100  700    0       0     0     0>
            , <&key_physical_attrs 100 100  800    0       0     0     0>
            , <&key_physical_attrs 100 100  900    0       0     0     0>
            , <&key_physical_attrs 100 100  1000   0       0     0     0>
            , <&key_physical_attrs 100 100  1100   0       0     0     0>
            , <&key_physical_attrs 100 100  1200   0       0     0     0>
            , <&key_physical_attrs 100 100  1300   0       0     0     0>
            , <&key_physical_attrs 100 100  1400   0       0     0     0>
            , <&key_physical_attrs 100 100  1500   0       0     0     0>

            , <&key_physical_attrs 100 100  400    100     0     0     0>
            , <&key_physical_attrs 100 100  500    100     0     0     0>
            , <&key_physical_attrs 100 100  600    100     0     0     0>
            , <&key_physical_attrs 100 100  700    100     0     0     0>
            , <&key_physical_attrs 100 100  800    100     0     0     0>
            , <&key_physical_attrs 100 100  900    100     0     0     0>
            , <&key_physical_attrs 100 100  1000   100     0     0     0>
            , <&key_physical_attrs 100 100  1100   100     0     0     0>
            , <&key_physical_attrs 100 100  1200   100     0     0     0>
            , <&key_physical_attrs 100 100  1300   100     0     0     0>
            , <&key_physical_attrs 100 100  1400   100     0     0     0>
            , <&key_physical_attrs 100 100  1500   100     0     0     0>

            , <&key_physical_attrs 100 100    0    300     0     0     0>
            , <&key_physical_attrs 100 100  100    300     0     0     0>
            , <&key_physical_attrs 100 100  300    300     0     0     0>
            , <&key_physical_attrs 100 100  400    300     0     0     0>
            , <&key_physical_attrs 100 100  500    300     0     0     0>
            , <&key_physical_attrs 100 100  600    300     0     0     0>
            , <&key_physical_attrs 100 100  700    300     0     0     0>
            , <&key_physical_attrs 100 100  800    300     0     0     0>
            , <&key_physical_attrs 100 100  900    300     0     0     0>
            , <&key_physical_attrs 100 100  1000   300     0     0     0>
            , <&key_physical_attrs 100 100  1100   300     0     0     0>
            , <&key_physical_attrs 100 100  1200   300     0     0     0>
            , <&key_physical_attrs 100 100  1300   300     0     0     0>
            , <&key_physical_attrs 100 100  1400   300     0     0     0>
            , <&key_physical_attrs 100 100  1500   300     0     0     0>
            , <&key_physical_attrs 200 100  1600   300     0     0     0>
            , <&key_physical_attrs 100 100  1900   300     0     0     0>
            , <&key_physical_attrs 100 100  2000   300     0     0     0>
            , <&key_physical_attrs 100 100  2100   300     0     0     0>
            , <&key_physical_attrs 100 100  2300   300     0     0     0>
            , <&key_physical_attrs 100 100  2400   300     0     0     0>
            , <&key_physical_attrs 100 100  2500   300     0     0     0>
            , <&key_physical_attrs 100 100  2600   300     0     0     0>

            , <&key_physical_attrs 100 100    0    400     0     0     0>
            , <&key_physical_attrs 100 100  100    400     0     0     0>
            , <&key_physical_attrs 150 100  300    400     0     0     0>
            , <&key_physical_attrs 100 100  450    400     0     0     0>
            , <&key_physical_attrs 100 100  550    400     0     0     0>
            , <&key_physical_attrs 100 100  650    400     0     0     0>
            , <&key_physical_attrs 100 100  750    400     0     0     0>
            , <&key_physical_attrs 100 100  850    400     0     0     0>
            , <&key_physical_attrs 100 100  950    400     0     0     0>
            , <&key_physical_attrs 100 100  1050   400     0     0     0>
            , <&key_physical_attrs 100 100  1150   400     0     0     0>
            , <&key_physical_attrs 100 100  1250   400     0     0     0>
            , <&key_physical_attrs 100 100  1350   400     0     0     0>
            , <&key_physical_attrs 100 100  1450   400     0     0     0>
            , <&key_physical_attrs 100 100  1550   400     0     0     0>
            , <&key_physical_attrs 100 100  1900   400     0     0     0>
            , <&key_physical_attrs 100 100  2000   400     0     0     0>
            , <&key_physical_attrs 100 100  2100   400     0     0     0>
            , <&key_physical_attrs 100 100  2300   400     0     0     0>
            , <&key_physical_attrs 100 100  2400   400     0     0     0>
            , <&key_physical_attrs 100 100  2500   400     0     0     0>
            , <&key_physical_attrs 100 100  2600   400     0     0     0>

            , <&key_physical_attrs 100 100    0    500     0     0     0>
            , <&key_physical_attrs 100 100  100    500     0     0     0>
            , <&key_physical_attrs 175 100  300    500     0     0     0>
            , <&key_physical_attrs 100 100   475   500     0     0     0>
            , <&key_physical_attrs 100 100   575   500     0     0     0>
            , <&key_physical_attrs 100 100   675   500     0     0     0>
            , <&key_physical_attrs 100 100   775   500     0     0     0>
            , <&key_physical_attrs 100 100   875   500     0     0     0>
            , <&key_physical_attrs 100 100   975   500     0     0     0>
            , <&key_physical_attrs 100 100  1075   500     0     0     0>
            , <&key_physical_attrs 100 100  1175   500     0     0     0>
            , <&key_physical_attrs 100 100  1275   500     0     0     0>
            , <&key_physical_attrs 100 100  1375   500     0     0     0>
            , <&key_physical_attrs 100 100  1475   500     0     0     0>
            , <&key_physical_attrs 100 100  1575   500     0     0     0>
            , <&key_physical_attrs 125 200  1675   400     0     0     0>
            , <&key_physical_attrs 100 100  2000   500     0     0     0>
            , <&key_physical_attrs 100 100  2300   500     0     0     0>
            , <&key_physical_attrs 100 100  2400   500     0     0     0>
            , <&key_physical_attrs 100 100  2500   500     0     0     0>
            , <&key_physical_attrs 100 100  2600   500     0     0     0>

            , <&key_physical_attrs 100 100    0    600     0     0     0>
            , <&key_physical_attrs 100 100   100   600     0     0     0>
            , <&key_physical_attrs 125 100   300   600     0     0     0>
            , <&key_physical_attrs 100 100   425   600     0     0     0>
            , <&key_physical_attrs 100 100   525   600     0     0     0>
            , <&key_physical_attrs 100 100   625   600     0     0     0>
            , <&key_physical_attrs 100 100   725   600     0     0     0>
            , <&key_physical_attrs 100 100   825   600     0     0     0>
            , <&key_physical_attrs 100 100   925   600     0     0     0>
            , <&key_physical_attrs 100 100  1025   600     0     0     0>
            , <&key_physical_attrs 100 100  1125   600     0     0     0>
            , <&key_physical_attrs 100 100  1225   600     0     0     0>
            , <&key_physical_attrs 100 100  1325   600     0     0     0>
            , <&key_physical_attrs 100 100  1425   600     0     0     0>
            , <&key_physical_attrs 275 100  1525   600     0     0     0>
            , <&key_physical_attrs 100 100  1900   600     0     0     0>
            , <&key_physical_attrs 100 100  2000   600     0     0     0>
            , <&key_physical_attrs 100 100  2100   600     0     0     0>
            , <&key_physical_attrs 100 100  2300   600     0     0     0>
            , <&key_physical_attrs 100 100  2400   600     0     0     0>
            , <&key_physical_attrs 100 100  2500   600     0     0     0>
            , <&key_physical_attrs 100 200  2600   600     0     0     0>

            , <&key_physical_attrs 100 100    0    700     0     0     0>
            , <&key_physical_attrs 100 100  100    700     0     0     0>
            , <&key_physical_attrs 150 100  300    700     0     0     0>
            , <&key_physical_attrs 150 100  550    700     0     0     0>
            , <&key_physical_attrs 700 100  700    700     0     0     0>
            , <&key_physical_attrs 150 100  1400   700     0     0     0>
            , <&key_physical_attrs 150 100  1650   700     0     0     0>
            , <&key_physical_attrs 100 100  2000   700     0     0     0>
            , <&key_physical_attrs 200 100  2300   700     0     0     0>
            , <&key_physical_attrs 100 100  2500   700     0     0     0>
        ;
    };
     
    iso122_matrix_transform: iso122_matrix_transform {
        compatible = "zmk,matrix-transform";
        rows = <8>;
        columns = <20>;

        //                          -------------------------------------------------------------------------------------------------
        //                          | PF13  | PF14  | PF15  | PF16  | PF17  | PF18  | PF19  | PF20  | PF21  | PF22  | PF23  | PF24  |
        //                          | PF1   | PF2   | PF3   | PF4   | PF5   | PF6   | PF7   | PF8   | PF9   | PF10  | PF11  | PF12  |
        //  -------------------------------------------------------------------------------------------------------------------------------------------------
        //  | Attn  | Clear |       |  `    |  1    |  2    |  3    |  4    |  5    |  6    |  7    |  8    |  9    |  0    |  -    |  =    |   BKSP        |       | PA1   | PA2   | Blank |       | BLANK | BLANK | '     | Space |
        //  | Blank | ErImp |       |    TAB    |  Q    |  W    |  E    |  R    |  T    |  Y    |  U    |  I    |  O    |  P    |  Cent |   \   |   (ENTER) |       |DELETE | Home  |  ??   |       | KP 7  | KP 8  | KP 9  | END   |
        //  | ExSel | ErEOF |       | CAPS        |   A   |   S   |   D   |   F   |   G   |   H   |   J   |   K   |   L   |   ;   |   '   |   }   |  ENTER  |               |  UP   |               | KP 4  | KP 5  | KP 6  | KP -  |
        //  | Print |  Test |       | LSHIFT  |   <>  |   Z   |   X   |   C   |   V   |   B   |   N   |   M   |   ,   |   .   |   /   |        RSHIFT       |       | LEFT  | Blank | RIGHT |       | KP 1  | KP 2  | KP 3  | K ENT |
        //  |  ??   |  ??   |       |   Reset   |       |    ALT    |                        SPACE                          |    ALT    |       |   Enter   |               | DOWN  |               |     KP 0      | KP .  |(K ENT)|
        //  -------------------------------------------------------------------------------------------------------------------------------------------------
        map = <
        //                          ------------------------------------------------------------------------------------------------------------
        //                          | PF13   | PF14   | PF15   | PF16   | PF17   | PF18   | PF19   | PF20   | PF21   | PF22   | PF23   | PF24  |
                                    RC(0,9)  RC(1,9)  RC(1,10) RC(2,9)  RC(3,9)  RC(3,10) RC(4,9)  RC(5,9)  RC(5,10) RC(6,9)  RC(7,9)  RC(7,10)

        //                          | PF1    | PF2    | PF3    | PF4    | PF5    | PF6    | PF7    | PF8    | PF9    | PF10   | PF11   | PF12  |
                                    RC(0,10) RC(0,11) RC(1,11) RC(2,10) RC(2,11) RC(3,11) RC(4,10) RC(4,11) RC(5,11) RC(6,10) RC(6,11) RC(7,11)

        //  -------------------------------------------------------------------------------------------------------------------------------------------------
        //  | Attn  | Clear |       |  `    |  1    |  2    |  3    |  4    |  5    |  6    |  7    |  8    |  9    |  0    |  -    |  =    |   BKSP        |       | PA1   | PA2   | Blank |       | BLANK | BLANK | '     | Space |
            RC(3,1) RC(3,2)        RC(3,4) RC(2,4) RC(2,5) RC(2,6) RC(2,7) RC(3,7) RC(3,8) RC(2,8) RC(2,12) RC(2,13) RC(2,14) RC(3,14) RC(3,12)  RC(3,15)          RC(3,16) RC(3,17) RC(2,16)      RC(2,15) RC(2,17) RC(2,18) RC(2,0) 

        //  | Blank | ErImp |       |    TAB    |  Q    |  W    |  E    |  R    |  T    |  Y    |  U    |  I    |  O    |  P    |  Cent |   \   |   (ENTER) |       |DELETE | Home  |  ??   |       | KP 7  | KP 8  | KP 9  | END   |
            RC(2,1) RC(4,1)           RC(4,2)  RC(4,4) RC(4,5) RC(4,6) RC(4,7) RC(5,7) RC(5,8) RC(4,8) RC(4,12) RC(4,13) RC(4,14) RC(5,14) RC(5,12)                RC(1,16) RC(5,16) RC(4,16)      RC(4,15) RC(4,17) RC(4,18) RC(4,0) 

        //  | ExSel | ErEOF |       | CAPS        |   A   |   S   |   D   |   F   |   G   |   H   |   J   |   K   |   L   |   ;   |   '   |   }   |  ENTER  |               |  UP   |               | KP 4  | KP 5  | KP 6  | KP -  |
            RC(5,1) RC(5,2)           RC(6,2)    RC(1,4) RC(1,5) RC(1,6) RC(1,7) RC(0,7) RC(0,8) RC(1,8) RC(1,12) RC(1,13) RC(1,14) RC(0,14) RC(6,14) RC(6,15)              RC(0,16)               RC(1,15) RC(1,17) RC(1,18) RC(1,0) 

        //  | Print |  Test |       | LSHIFT  |   <>  |   Z   |   X   |   C   |   V   |   B   |   N   |   M   |   ,   |   .   |   /   |        RSHIFT       |       | LEFT  | Blank | RIGHT |       | KP 1  | KP 2  | KP 3  | K ENT |
            RC(1,1) RC(1,2)           RC(7,3) RC(7,4) RC(6,4) RC(6,5) RC(6,6) RC(6,7) RC(7,7) RC(7,8) RC(6,8) RC(6,12) RC(6,13) RC(7,14)       RC(6,3)             RC(6,0)  RC(0,19) RC(1,19)      RC(6,1)  RC(6,17) RC(6,18) RC(7,19) 

        //  |  ??   |  ??   |       |   Reset   |       |    ALT    |                        SPACE                          |    ALT    |       |   Enter   |               | DOWN  |               |     KP 0      | KP .  |(K ENT)|
            RC(0,2) RC(0,1)         RC(0,0)                RC(7,0)                          RC(7,1)                            RC(0,3)             RC(7,2)                  RC(0,15)                    RC(7,17)    RC(7,18)
        >;
    };
    
};